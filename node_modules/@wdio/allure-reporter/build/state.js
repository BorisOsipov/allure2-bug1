import { sep } from 'node:path';
import { AllureGroup, AllureTest, AllureStep } from 'allure-js-commons';
import { findLast } from './utils.js';
export class AllureReporterState {
    currentFile;
    runningUnits = [];
    get currentSuite() {
        return findLast(this.runningUnits, (unit) => unit instanceof AllureGroup);
    }
    get currentTest() {
        return findLast(this.runningUnits, (unit) => unit instanceof AllureTest);
    }
    get currentStep() {
        return findLast(this.runningUnits, (unit) => unit instanceof AllureStep);
    }
    get currentAllureTestOrStep() {
        return findLast(this.runningUnits, (unit) => unit instanceof AllureTest || unit instanceof AllureStep);
    }
    get currentPackageLabel() {
        if (!this.currentFile) {
            return undefined;
        }
        return this.currentFile.replaceAll(sep, '.');
    }
    push(unit) {
        this.runningUnits.push(unit);
    }
    pop() {
        return this.runningUnits.pop();
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RhdGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvc3RhdGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLEdBQUcsRUFBRSxNQUFNLFdBQVcsQ0FBQTtBQUMvQixPQUFPLEVBQUUsV0FBVyxFQUFFLFVBQVUsRUFBRSxVQUFVLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQTtBQUN2RSxPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0sWUFBWSxDQUFBO0FBRXJDLE1BQU0sT0FBTyxtQkFBbUI7SUFDNUIsV0FBVyxDQUFTO0lBQ3BCLFlBQVksR0FBaUQsRUFBRSxDQUFBO0lBRS9ELElBQUksWUFBWTtRQUNaLE9BQU8sUUFBUSxDQUFDLElBQUksQ0FBQyxZQUFZLEVBQUUsQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDLElBQUksWUFBWSxXQUFXLENBQTRCLENBQUE7SUFDeEcsQ0FBQztJQUVELElBQUksV0FBVztRQUNYLE9BQU8sUUFBUSxDQUFDLElBQUksQ0FBQyxZQUFZLEVBQUUsQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDLElBQUksWUFBWSxVQUFVLENBQTJCLENBQUE7SUFDdEcsQ0FBQztJQUVELElBQUksV0FBVztRQUNYLE9BQU8sUUFBUSxDQUFDLElBQUksQ0FBQyxZQUFZLEVBQUUsQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDLElBQUksWUFBWSxVQUFVLENBQTJCLENBQUE7SUFDdEcsQ0FBQztJQUVELElBQUksdUJBQXVCO1FBQ3ZCLE9BQU8sUUFBUSxDQUFDLElBQUksQ0FBQyxZQUFZLEVBQUUsQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDLElBQUksWUFBWSxVQUFVLElBQUksSUFBSSxZQUFZLFVBQVUsQ0FBd0MsQ0FBQTtJQUNqSixDQUFDO0lBRUQsSUFBSSxtQkFBbUI7UUFDbkIsSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUU7WUFDbkIsT0FBTyxTQUFTLENBQUE7U0FDbkI7UUFFRCxPQUFPLElBQUksQ0FBQyxXQUFXLENBQUMsVUFBVSxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQTtJQUNoRCxDQUFDO0lBRUQsSUFBSSxDQUFDLElBQTJDO1FBQzVDLElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFBO0lBQ2hDLENBQUM7SUFFRCxHQUFHO1FBQ0MsT0FBTyxJQUFJLENBQUMsWUFBWSxDQUFDLEdBQUcsRUFBRSxDQUFBO0lBQ2xDLENBQUM7Q0FDSiJ9